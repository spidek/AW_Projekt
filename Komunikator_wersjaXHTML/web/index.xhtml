<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core" >
<!--      xmlns:a4j="http://richfaces.org/a4j" >-->
    <f:view>
        <h:head>
            <title>Komunikator internetowy</title>
            <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
            <link type="text/css" rel="stylesheet" href="style/style.css" /> 
            <script src="http://code.jquery.com/jquery-latest.js"></script>
            <script>
                $(document).ready(function() {
                 	 $("#chatForm\\:chatbox").load("chat.html");
//                var refreshId = setInterval(function() {
//                //      $("#chatbox").load('chat.html');
////                        alert("Działaj!");
//                }, 5000);
//                $.ajaxSetup({ cache: false });

//                  $("#chatbox").load("/chat.html", function(response, status, xhr) {
//                    if (status == "error") {
//                        var msg = "Sorry but there was an error: ";
//                        $("#chatbox").html(msg + xhr.status + " " + xhr.statusText);
//                    }
//                $("#chatbox").html("Hello");
                });
            </script>
        </h:head>
        <h:body>  
<!--            <a4j:region>
                <h:form>
                    <a4j:poll id="poll" interval="500" enabled="true"
                        reRender="chatbox" />
                </h:form>
            </a4j:region>-->
            <h:form id="chatForm">
                <div id="wrapper">
                    <div id="menu">
                        <p class="welcome">Witaj, <b><h:outputText value="#{User.name}" /></b></p> <!-- <%= session.getAttribute("name") %> -->
                        <p class="logout">
                            <h:outputLink value="logowanie.xhtml"> 
                                <h:outputText value="Wyjście z czatu"/> 
                            </h:outputLink>
                        </p>
                        <div style="clear:both"> </div>
                    </div>      
<!--                  <div id="chatbox" ></div> -->
                <h:inputTextarea id="chatbox" class="chat" readonly="true" />

                    <h:selectManyListbox id="userList" class="user">
                        <f:selectItems value="#{Chat.returnUserzy()}" />
                    </h:selectManyListbox>

                <h:inputText id="userMessage" class="uMessage" value="#{Message.message}" required="true"/>
                <h:commandButton id="submitMessage" value="Wyślij" action="#{Chat.addMessage(User.writeMessage(Message))}" />    
                </div>
            </h:form>
        </h:body>
    </f:view>
</html>

